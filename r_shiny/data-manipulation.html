<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Starting Out with R and Shiny</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This is a booklike set of lesson plans on starting out with R, with the goal of writing Shiny dashboards.">
  <meta name="generator" content="bookdown 0.0.72 and GitBook 2.6.7">

  <meta property="og:title" content="Starting Out with R and Shiny" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a booklike set of lesson plans on starting out with R, with the goal of writing Shiny dashboards." />
  <meta name="github-repo" content="ironholds/simpler" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Starting Out with R and Shiny" />
  
  <meta name="twitter:description" content="This is a booklike set of lesson plans on starting out with R, with the goal of writing Shiny dashboards." />
  

<meta name="author" content="Oliver Keyes">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="reshaping-data.html">
<link rel="next" href="building-your-first-app.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preamble</a></li>
<li class="part"><span><b>Introduction to R</b></span></li>
<li class="chapter" data-level="1" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>1</b> Background</a><ul>
<li class="chapter" data-level="1.1" data-path="background.html"><a href="background.html#a-brief-history-of-splines"><i class="fa fa-check"></i><b>1.1</b> A brief history of splines</a></li>
<li class="chapter" data-level="1.2" data-path="background.html"><a href="background.html#why-r-succeeds"><i class="fa fa-check"></i><b>1.2</b> Why R succeeds</a></li>
<li class="chapter" data-level="1.3" data-path="background.html"><a href="background.html#the-r-community"><i class="fa fa-check"></i><b>1.3</b> The R community</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-set-up.html"><a href="getting-set-up.html"><i class="fa fa-check"></i><b>2</b> Getting set up</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-set-up.html"><a href="getting-set-up.html#installation"><i class="fa fa-check"></i><b>2.1</b> Installation</a></li>
<li class="chapter" data-level="2.2" data-path="getting-set-up.html"><a href="getting-set-up.html#using-rstudio"><i class="fa fa-check"></i><b>2.2</b> Using RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="getting-set-up.html"><a href="getting-set-up.html#tutorial-format"><i class="fa fa-check"></i><b>2.3</b> Tutorial format</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-import-and-export.html"><a href="data-import-and-export.html"><i class="fa fa-check"></i><b>3</b> Data Import and Export</a><ul>
<li class="chapter" data-level="3.1" data-path="data-import-and-export.html"><a href="data-import-and-export.html#importing-from-csvs"><i class="fa fa-check"></i><b>3.1</b> Importing from CSVs</a></li>
<li class="chapter" data-level="3.2" data-path="data-import-and-export.html"><a href="data-import-and-export.html#importing-excel-spreadsheets"><i class="fa fa-check"></i><b>3.2</b> Importing Excel spreadsheets</a></li>
<li class="chapter" data-level="3.3" data-path="data-import-and-export.html"><a href="data-import-and-export.html#other-files"><i class="fa fa-check"></i><b>3.3</b> Other files</a></li>
<li class="chapter" data-level="3.4" data-path="data-import-and-export.html"><a href="data-import-and-export.html#database-import"><i class="fa fa-check"></i><b>3.4</b> Database import</a></li>
<li class="chapter" data-level="3.5" data-path="data-import-and-export.html"><a href="data-import-and-export.html#exporting-data"><i class="fa fa-check"></i><b>3.5</b> Exporting data</a></li>
</ul></li>
<li class="part"><span><b>Cleaning Data</b></span></li>
<li class="chapter" data-level="4" data-path="text-cleaning.html"><a href="text-cleaning.html"><i class="fa fa-check"></i><b>4</b> Text-cleaning</a></li>
<li class="chapter" data-level="5" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>5</b> Dates and times</a></li>
<li class="chapter" data-level="6" data-path="reshaping-data.html"><a href="reshaping-data.html"><i class="fa fa-check"></i><b>6</b> Reshaping data</a></li>
<li class="chapter" data-level="7" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>7</b> Data manipulation</a></li>
<li class="part"><span><b>Shiny</b></span></li>
<li class="chapter" data-level="8" data-path="building-your-first-app.html"><a href="building-your-first-app.html"><i class="fa fa-check"></i><b>8</b> Building your first app</a></li>
<li class="chapter" data-level="9" data-path="user-interface-design.html"><a href="user-interface-design.html"><i class="fa fa-check"></i><b>9</b> User Interface design</a></li>
<li class="chapter" data-level="10" data-path="custom-inputs-and-outputs.html"><a href="custom-inputs-and-outputs.html"><i class="fa fa-check"></i><b>10</b> Custom inputs and outputs</a></li>
<li class="chapter" data-level="11" data-path="reactive-expressions.html"><a href="reactive-expressions.html"><i class="fa fa-check"></i><b>11</b> Reactive expressions</a></li>
<li class="chapter" data-level="12" data-path="shiny-dashboarding.html"><a href="shiny-dashboarding.html"><i class="fa fa-check"></i><b>12</b> Shiny dashboarding</a></li>
<li class="part"><span><b>Advanced</b></span></li>
<li class="chapter" data-level="13" data-path="code-style.html"><a href="code-style.html"><i class="fa fa-check"></i><b>13</b> Code style</a></li>
<li class="chapter" data-level="14" data-path="version-control.html"><a href="version-control.html"><i class="fa fa-check"></i><b>14</b> Version control</a></li>
<li class="chapter" data-level="15" data-path="testing-and-staging.html"><a href="testing-and-staging.html"><i class="fa fa-check"></i><b>15</b> Testing and staging</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Starting Out with R and Shiny</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-manipulation" class="section level1">
<h1><span class="header-section-number">7</span> Data manipulation</h1>
<p>Beyond tidying data, another common need is to aggregate it. Raw data, split by as many variables as possible, gives us the widest possible amount of information, but that doesn’t mean it’s easy to visualise (<code>patient_data</code> has 23,578 observations, for example. Nobody wants a 23,000 point graphic) or understand.</p>
<p>Data manipulation is the practice of reshaping, aggregating or splitting data to make it easier to use for a particular task. If you’re exploring data, that might look like aggregating it at a very high level to get a general feel for what things look like. If you’re visualising it, that might look like calculating particular metrics for entire groups of observations, and getting a data frame out at the end you can turn into a graph. In these cases, and a wide range of other cases, the answer is another R package: <code>dplyr</code>.</p>
<p><code>dplyr</code> provides a “grammar” of data manipulation: a set of functions that can be strung together into almost a sentence that describes what’s being done to the data. For example, if we wanted to summarise, for each facility, the number of admitted patients in the 10-19 age group, we would <code>filter</code> the dataset to 10-19, <code>group</code> the entries by facility name, and <code>summarize</code> the dataset to get the mean.</p>
<p>This language-like construct is aided by a new operator that we’ll introduce: <code>%&gt;%</code>, or the “pipe” operator. Normally, R consists of a series of statements with assignment operations in them:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">start_data &lt;-<span class="st"> &quot;foo&quot;</span>
result_of_first_step &lt;-<span class="st"> </span><span class="kw">do_thing</span>(start_data)
result_of_second_step &lt;-<span class="st"> </span><span class="kw">do_second_thing</span>(result_of_first_step)
final_result &lt;-<span class="st"> </span><span class="kw">do_third_thing</span>(result_of_second_step)</code></pre></div>
<p>The pipe operator lets us “chain” operations together. If you put pipe operatiors between function calls, it will automatically pass the result of the first call into the second, and second to the third, and so on until it runs out of pipe operators (and function calls) and returns the result. This means instead of assigning things 3 times for 3 operations, we assign things..once:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">start_data &lt;-<span class="st"> &quot;foo&quot;</span>
final_result &lt;-<span class="st"> </span><span class="kw">do_thing</span>(start_data) %&gt;%
<span class="st">                  </span>do_second_thing %&gt;%
<span class="st">                  </span>do_third_thing</code></pre></div>
<p>The code is much cleaner and much easier to read, and when you add the “language”-like aspect of dplyr and tidyr in, it becomes almost a sentence. Let’s demonstrate by taking the patient data dataset, and then working out the average number of 10-19 year olds admitted to facilities a year:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">facility_admission_average &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="st">&quot;https://www.ironholds.org/resources/misc/patient_data.csv&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(age_group ==<span class="st"> &quot;10-19&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(year) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">admission_average =</span> <span class="kw">mean</span>(admitted))

<span class="kw">head</span>(facility_admission_average)

   year admission_average
  &lt;int&gt;<span class="st">             </span><span class="er">&lt;</span>dbl&gt;
<span class="dv">1</span>  <span class="dv">2009</span>          <span class="fl">418.5859</span>
<span class="dv">2</span>  <span class="dv">2010</span>          <span class="fl">407.1007</span>
<span class="dv">3</span>  <span class="dv">2011</span>          <span class="fl">390.5659</span>
<span class="dv">4</span>  <span class="dv">2012</span>          <span class="fl">378.8952</span>
<span class="dv">5</span>  <span class="dv">2013</span>          <span class="fl">356.8860</span>
<span class="dv">6</span>  <span class="dv">2014</span>          <span class="fl">350.0652</span></code></pre></div>
<p>And just like that we’ve gone from raw data to averaged hospital admissions, by year, for a particular age group - although we probably should have rounded the results. I’m not sure if you can admit half a patient. Certainly not without a rather grim prognosis.</p>

</div>



            </section>

          </div>
        </div>
      </div>
<a href="reshaping-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="building-your-first-app.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
